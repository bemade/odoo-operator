---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    helm.sh/resource-policy: keep
  name: odoobackupjobs.bemade.org
spec:
  group: bemade.org
  names:
    categories: []
    kind: OdooBackupJob
    plural: odoobackupjobs
    shortNames:
    - backupjob
    singular: odoobackupjob
  scope: Namespaced
  versions:
{{- include "odoo-operator.v1LegacyVersion" . | nindent 2 }}
  - additionalPrinterColumns:
    - jsonPath: .spec.odooInstanceRef.name
      name: Target
      type: string
    - jsonPath: .spec.format
      name: Format
      type: string
    - jsonPath: .status.phase
      name: Phase
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Auto-generated derived type for OdooBackupJobSpec via `CustomResource`
        properties:
          spec:
            description: OdooBackupJob runs a one-shot backup of an OdooInstance to S3.
            properties:
              destination:
                description: BackupDestination specifies where to store the backup artifact.
                properties:
                  bucket:
                    type: string
                  endpoint:
                    type: string
                  insecure:
                    default: false
                    type: boolean
                  objectKey:
                    type: string
                  region:
                    nullable: true
                    type: string
                  s3CredentialsSecretRef:
                    description: SecretReference represents a Secret Reference. It has enough information to retrieve secret in any namespace
                    nullable: true
                    properties:
                      name:
                        description: name is unique within a namespace to reference a secret resource.
                        type: string
                      namespace:
                        description: namespace defines the space within which the secret name must be unique.
                        type: string
                    type: object
                required:
                - bucket
                - endpoint
                - objectKey
                type: object
              format:
                default: zip
                description: BackupFormat specifies the format of the backup artifact.
                enum:
                - zip
                - sql
                - dump
                type: string
              odooInstanceRef:
                description: OdooInstanceRef is a reference to an OdooInstance resource.
                properties:
                  name:
                    type: string
                  namespace:
                    nullable: true
                    type: string
                required:
                - name
                type: object
              webhook:
                description: WebhookConfig defines an optional webhook callback for job completion notifications.
                nullable: true
                properties:
                  secretTokenSecretRef:
                    description: SecretKeySelector selects a key from a Secret.
                    nullable: true
                    properties:
                      key:
                        type: string
                      name:
                        type: string
                    required:
                    - key
                    - name
                    type: object
                  token:
                    nullable: true
                    type: string
                  url:
                    type: string
                required:
                - url
                type: object
              withFilestore:
                default: true
                type: boolean
            required:
            - destination
            - odooInstanceRef
            type: object
          status:
            description: OdooBackupJobStatus defines the observed state of OdooBackupJob.
            nullable: true
            properties:
              completionTime:
                nullable: true
                type: string
              conditions:
                items:
                  description: Condition contains details for one aspect of the current state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: lastTransitionTime is the last time the condition transitioned from one status to another. This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: message is a human readable message indicating details about the transition. This may be an empty string.
                      type: string
                    observedGeneration:
                      description: observedGeneration represents the .metadata.generation that the condition was set based upon. For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date with respect to the current state of the instance.
                      format: int64
                      type: integer
                    reason:
                      description: reason contains a programmatic identifier indicating the reason for the condition's last transition. Producers of specific condition types may define expected values and meanings for this field, and whether the values are considered a guaranteed API. The value should be a CamelCase string. This field may not be empty.
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              jobName:
                nullable: true
                type: string
              message:
                nullable: true
                type: string
              phase:
                description: Phase represents the lifecycle state of a job resource.
                enum:
                - Pending
                - Running
                - Completed
                - Failed
                nullable: true
                type: string
              startTime:
                nullable: true
                type: string
            type: object
        required:
        - spec
        title: OdooBackupJob
        type: object
    served: true
    storage: true
    subresources:
      status: {}
